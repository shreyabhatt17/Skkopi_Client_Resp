!function(t,e){"object"==typeof exports&&"undefined"!=typeof module?e(exports,require("@angular/core"),require("rxjs"),require("rxjs/operators"),require("@angular/forms"),require("@angular/common")):"function"==typeof define&&define.amd?define("autocomplete-lib",["exports","@angular/core","rxjs","rxjs/operators","@angular/forms","@angular/common"],e):e(t["autocomplete-lib"]={},t.ng.core,t.rxjs,t.rxjs.operators,t.ng.forms,t.ng.common)}(this,function(t,e,i,n,s,o){"use strict";var r=function(){function t(){}return t.decorators=[{type:e.Injectable,args:[{providedIn:"root"}]}],t.ctorParameters=function(){return[]},t.ngInjectableDef=e.defineInjectable({factory:function(){return new t},token:t,providedIn:"root"}),t}(),a=function(){function t(){}return t.prototype.ngOnInit=function(){},t.decorators=[{type:e.Component,args:[{selector:"ng-autocomplete-lib",template:"\n    <p>\n      autocomplete-lib works!\n    </p>\n  ",styles:[]}]}],t.ctorParameters=function(){return[]},t}(),c=function(){return(c=Object.assign||function(t){for(var e,i=1,n=arguments.length;i<n;i++)for(var s in e=arguments[i])Object.prototype.hasOwnProperty.call(e,s)&&(t[s]=e[s]);return t}).apply(this,arguments)};function l(t,e){var i="function"==typeof Symbol&&t[Symbol.iterator];if(!i)return t;var n,s,o=i.call(t),r=[];try{for(;(void 0===e||0<e--)&&!(n=o.next()).done;)r.push(n.value)}catch(a){s={error:a}}finally{try{n&&!n.done&&(i=o["return"])&&i.call(o)}finally{if(s)throw s.error}}return r}function d(){for(var t=[],e=0;e<arguments.length;e++)t=t.concat(l(arguments[e]));return t}var h=function(t){return 38===t||40===t},p=function(t){return 13===t},u=function(t){return 27===t},g=function(){function t(t){this.query="",this.filteredList=[],this.historyList=[],this.isHistoryListVisible=!0,this.toHighlight="",this.notFound=!1,this.data=[],this.placeHolder="",this.historyHeading="Recently selected",this.historyListMaxNumber=15,this.notFoundText="Not found",this.selected=new e.EventEmitter,this.inputChanged=new e.EventEmitter,this.inputFocused=new e.EventEmitter,this.opened=new e.EventEmitter,this.closed=new e.EventEmitter,this.elementRef=t,this.selectedIdx=-1}return t.prototype.ngOnInit=function(){this.initEventStream(),this.setInitialValue(this.initialValue)},t.prototype.setInitialValue=function(t){this.initialValue&&this.select(t)},t.prototype.ngOnChanges=function(t){t&&t.data&&Array.isArray(t.data.currentValue)&&!t.data.firstChange&&this.isFocused&&this.open()},t.prototype.filterList=function(){var e=this;this.initSearchHistory(),null!=this.query&&this.data?(this.toHighlight=this.query,this.filteredList=this.data.filter(function(t){return"string"==typeof t?-1<t.toLowerCase().indexOf(e.query.toLowerCase()):"object"==typeof t&&t.constructor===Object?-1<t[e.searchKeyword].toLowerCase().indexOf(e.query.toLowerCase()):void 0})):this.notFound=!1},t.prototype.isType=function(t){return"string"==typeof t},t.prototype.select=function(e){var i=this;if(this.query=this.isType(e)?e:e[this.searchKeyword],this.selected.emit(e),this.initialValue)if(window.localStorage.getItem(""+this.historyIdentifier)){var t=JSON.parse(localStorage[""+this.historyIdentifier]);t instanceof Array||(t=[]),t.some(function(t){return i.isType(t)?t==e:t[i.searchKeyword]==e[i.searchKeyword]})||(t.unshift(e),localStorage.setItem(""+this.historyIdentifier,JSON.stringify(t)),t.length>=this.historyListMaxNumber&&(t.splice(t.length-1,1),localStorage.setItem(""+this.historyIdentifier,JSON.stringify(t))))}else this.saveHistory(e);else this.saveHistory(e);this.close()},t.prototype.handleClick=function(t){for(var e=t.target,i=!1;e===this.elementRef.nativeElement&&(i=!0,this.filteredList.length&&this.open()),e=e.parentNode;);i||this.close()},t.prototype.remove=function(){this.query="",this.close()},t.prototype.initSearchHistory=function(){if(this.isHistoryListVisible=!1,this.historyIdentifier&&!this.query){var t=window.localStorage.getItem(""+this.historyIdentifier);t?(this.isHistoryListVisible=!0,this.filteredList=[],this.historyList=t?JSON.parse(t):[]):this.isHistoryListVisible=!1}else this.isHistoryListVisible=!1},t.prototype.open=function(){this.isOpen||this.isOpen&&!this.isLoading||this.data&&this.data.length&&(this.filterList(),this.opened.emit(),this.isOpen=!0)},t.prototype.close=function(){this.isOpen&&(this.filteredList=[],this.selectedIdx=-1,this.notFound=!1,this.isHistoryListVisible=!1,this.isFocused=!1,this.closed.emit(),this.isOpen=!1)},t.prototype.focus=function(t){this.isFocused||(this.data&&this.data.length&&this.open(),this.inputFocused.emit(t),this.isFocused=!0)},t.prototype.initEventStream=function(){this.inputKeyUp$=i.fromEvent(this.searchInput.nativeElement,"keyup").pipe(n.map(function(t){return t})),this.inputKeyDown$=i.fromEvent(this.searchInput.nativeElement,"keydown").pipe(n.map(function(t){return t})),this.listenEventStream()},t.prototype.listenEventStream=function(){var e=this;this.inputKeyUp$.pipe(n.filter(function(t){return!(h(t.keyCode)||p(t.keyCode)||u(t.keyCode)||9===t.keyCode)}),n.debounceTime(this.debounceTime)).subscribe(function(t){e.onKeyUp(t)}),this.inputKeyDown$.pipe(n.filter(function(t){return h(t.keyCode)})).subscribe(function(t){t.preventDefault(),e.onFocusNextItem(t)}),this.inputKeyUp$.pipe(n.filter(function(t){return p(t.keyCode)})).subscribe(function(t){e.onHandleEnter()}),this.inputKeyUp$.pipe(n.filter(function(t){return u(t.keyCode)},n.debounceTime(100))).subscribe(function(t){e.onEsc()}),this.inputKeyDown$.pipe(n.filter(function(t){return 8===t.keyCode||46===t.keyCode})).subscribe(function(t){e.onDelete()})},t.prototype.onKeyUp=function(t){this.notFound=!1,this.query||(this.notFound=!1),this.inputChanged.emit(t.target.value),this.filterList(),this.filteredList.length||(this.notFoundText?this.notFound=!0:this.notFound=!1)},t.prototype.onFocusNextItem=function(t){this.historyList.length&&this.isHistoryListVisible?"ArrowDown"===t.code&&this.selectedIdx<this.historyList.length-1?this.selectedIdx++:"ArrowUp"===t.code&&0<this.selectedIdx&&this.selectedIdx--:"ArrowDown"===t.code&&this.selectedIdx<this.filteredList.length-1?this.selectedIdx++:"ArrowUp"===t.code&&0<this.selectedIdx&&this.selectedIdx--},t.prototype.onHandleEnter=function(){-1<this.selectedIdx&&(this.historyList.length&&this.isHistoryListVisible?(this.query=this.isType(this.historyList[this.selectedIdx])?this.historyList[this.selectedIdx]:this.historyList[this.selectedIdx][this.searchKeyword],this.saveHistory(this.historyList[this.selectedIdx]),this.select(this.historyList[this.selectedIdx])):(this.query=this.isType(this.filteredList[this.selectedIdx])?this.filteredList[this.selectedIdx]:this.filteredList[this.selectedIdx][this.searchKeyword],this.saveHistory(this.filteredList[this.selectedIdx]),this.select(this.filteredList[this.selectedIdx]))),this.isHistoryListVisible=!1,this.close()},t.prototype.onEsc=function(){this.searchInput.nativeElement.blur(),this.close()},t.prototype.onDelete=function(){},t.prototype.saveHistory=function(e){var i=this;this.historyIdentifier&&(this.historyList.some(function(t){return i.isType(t)?t==e:t[i.searchKeyword]==e[i.searchKeyword]})||(this.saveHistoryToLocalStorage(d([e],this.historyList)),this.historyList.length>=this.historyListMaxNumber&&(this.historyList.splice(this.historyList.length-1,1),this.saveHistoryToLocalStorage(d([e],this.historyList)))))},t.prototype.saveHistoryToLocalStorage=function(t){window.localStorage.setItem(""+this.historyIdentifier,JSON.stringify(t))},t.prototype.removeHistoryItem=function(i,t){t.stopPropagation(),this.historyList=this.historyList.filter(function(t,e){return e!==i}),this.saveHistoryToLocalStorage(this.historyList),0==this.historyList.length&&(window.localStorage.removeItem(""+this.historyIdentifier),this.filterList())},t.prototype.resetHistoryList=function(t){t.stopPropagation(),this.historyList=[],window.localStorage.removeItem(""+this.historyIdentifier),this.filterList()},t.decorators=[{type:e.Component,args:[{selector:"ng-autocomplete",template:'<div class="autocomplete-container">\n  <div class="input-container">\n    <input #searchInput type="text" placeholder={{placeHolder}}\n           [(ngModel)]=query\n           (focus)=focus($event)>\n    <div class="x" *ngIf="query && !isLoading" (click)="remove()">\n      <i class="material-icons">close</i>\n    </div>\n    \x3c!--Loading mask--\x3e\n    <div class="sk-fading-circle" *ngIf="isLoading">\n      <div class="sk-circle1 sk-circle"></div>\n      <div class="sk-circle2 sk-circle"></div>\n      <div class="sk-circle3 sk-circle"></div>\n      <div class="sk-circle4 sk-circle"></div>\n      <div class="sk-circle5 sk-circle"></div>\n      <div class="sk-circle6 sk-circle"></div>\n      <div class="sk-circle7 sk-circle"></div>\n      <div class="sk-circle8 sk-circle"></div>\n      <div class="sk-circle9 sk-circle"></div>\n      <div class="sk-circle10 sk-circle"></div>\n      <div class="sk-circle11 sk-circle"></div>\n      <div class="sk-circle12 sk-circle"></div>\n    </div>\n  </div>\n\n  \x3c!--FilteredList items--\x3e\n  <div class="suggestions-container"\n       [ngClass]="{ \'is-hidden\': isHistoryListVisible, \'is-visible\': !isHistoryListVisible}">\n    <ul>\n      <li *ngFor="let item of filteredList; let idx = index">\n        \x3c!--string logic--\x3e\n        <div [class.complete-selected]="idx === selectedIdx" *ngIf=\'isType(item)\'\n             (click)="select(item)">\n          <ng-container\n            *ngTemplateOutlet="itemTemplate;  context: { $implicit: item | highlight: toHighlight }">\n          </ng-container>\n        </div>\n        \x3c!--object logic--\x3e\n        <div [class.complete-selected]="idx === selectedIdx" *ngIf=\'!isType(item)\'\n             (click)="select(item)">\n          <ng-container\n            *ngTemplateOutlet="itemTemplate; context: { $implicit: item | highlight: toHighlight : searchKeyword }">\n          </ng-container>\n        </div>\n\n      </li>\n    </ul>\n  </div>\n\n  \x3c!--HistoryList items--\x3e\n  <div class="suggestions-container"\n       [ngClass]="{ \'is-hidden\': !isHistoryListVisible, \'is-visible\': isHistoryListVisible}">\n    \x3c!--HistoryList heading--\x3e\n    <div class="history-heading" *ngIf="historyList.length > 0 && historyHeading">\n      <div class="text">{{historyHeading}}</div>\n      <div class="x" (click)="resetHistoryList($event)">\n        <i class="material-icons">delete</i>\n      </div>\n    </div>\n\n    <ul *ngFor="let item of historyList; let idx = index">\n      <li [class.complete-selected]="idx === selectedIdx">\n        \x3c!--string logic--\x3e\n        <div *ngIf=\'isType(item)\' (click)="select(item)">\n          <ng-container\n            *ngTemplateOutlet="itemTemplate;  context: { $implicit: item }">\n          </ng-container>\n        </div>\n        \x3c!--object logic--\x3e\n        <div *ngIf=\'!isType(item)\' (click)="select(item)">\n          <ng-container\n            *ngTemplateOutlet="itemTemplate; context: { $implicit: item }">\n          </ng-container>\n        </div>\n        <div class="x" (click)="removeHistoryItem(idx, $event)">\n          <i class="material-icons">close</i>\n        </div>\n      </li>\n    </ul>\n  </div>\n\n  \x3c!--Not found--\x3e\n  <div class="not-found" *ngIf="isLoading ? !isLoading && notFound : notFound">\n    <ng-container\n      *ngTemplateOutlet="notFoundTemplate;  context: { $implicit: notFoundText  }">\n    </ng-container>\n  </div>\n</div>\n',styles:["@import url(https://fonts.googleapis.com/icon?family=Material+Icons);.ng-autocomplete{width:600px}.autocomplete-container{box-shadow:0 1px 3px 0 rgba(0,0,0,.2),0 1px 1px 0 rgba(0,0,0,.14),0 2px 1px -1px rgba(0,0,0,.12);position:relative;overflow:visible;height:40px}.autocomplete-container .input-container input{font-size:14px;box-sizing:border-box;border:none;box-shadow:none;outline:0;background:0 0;color:rgba(0,0,0,.87);width:100%;padding:0 15px;line-height:40px;height:40px}.autocomplete-container .input-container .x{position:absolute;right:10px;margin:auto;cursor:pointer;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%)}.autocomplete-container .input-container .x i{color:rgba(0,0,0,.54);font-size:22px;vertical-align:middle}.autocomplete-container .suggestions-container{border:1px solid #f1f1f1;position:absolute;width:100%;background:#fff;height:auto;box-sizing:border-box;max-height:240px;overflow-y:auto}.autocomplete-container .suggestions-container ul{padding:0;margin:0}.autocomplete-container .suggestions-container ul li{position:relative;list-style:none;padding:0;margin:0;cursor:pointer;overflow:hidden}.autocomplete-container .suggestions-container ul li a{padding:5px 15px;display:block;text-decoration:none;cursor:pointer;color:rgba(0,0,0,.87);font-size:15px}.autocomplete-container .suggestions-container .complete-selected,.autocomplete-container .suggestions-container ul li:hover{background-color:rgba(158,158,158,.18)}.autocomplete-container .suggestions-container .history-heading{position:relative;padding:0 .75em}.autocomplete-container .suggestions-container .history-heading .text{padding:.3em 0;font-size:.85em;line-height:1.4;border-bottom:1px solid rgba(230,230,230,.7)}.autocomplete-container .suggestions-container .x{position:absolute;right:10px;margin:auto;cursor:pointer;top:50%;-webkit-transform:translateY(-50%);transform:translateY(-50%)}.autocomplete-container .suggestions-container .x i{color:rgba(0,0,0,.54);font-size:18px;vertical-align:middle}.autocomplete-container .suggestions-container.is-hidden{visibility:hidden}.autocomplete-container .suggestions-container.is-visible{visibility:visible}.autocomplete-container .not-found{padding:0 .75em;border:1px solid #f1f1f1;background:#fff}.autocomplete-container .not-found div{padding:.4em 0;font-size:.95em;line-height:1.4;border-bottom:1px solid rgba(230,230,230,.7)}.highlight{font-weight:700}.sk-fading-circle{width:20px;height:20px;position:absolute;right:10px;top:0;bottom:0;margin:auto}.sk-fading-circle .sk-circle{width:100%;height:100%;position:absolute;left:0;top:0}.sk-fading-circle .sk-circle:before{content:'';display:block;margin:0 auto;width:15%;height:15%;background-color:#333;border-radius:100%;-webkit-animation:1.2s ease-in-out infinite both sk-circleFadeDelay;animation:1.2s ease-in-out infinite both sk-circleFadeDelay}.sk-fading-circle .sk-circle2{-webkit-transform:rotate(30deg);transform:rotate(30deg)}.sk-fading-circle .sk-circle3{-webkit-transform:rotate(60deg);transform:rotate(60deg)}.sk-fading-circle .sk-circle4{-webkit-transform:rotate(90deg);transform:rotate(90deg)}.sk-fading-circle .sk-circle5{-webkit-transform:rotate(120deg);transform:rotate(120deg)}.sk-fading-circle .sk-circle6{-webkit-transform:rotate(150deg);transform:rotate(150deg)}.sk-fading-circle .sk-circle7{-webkit-transform:rotate(180deg);transform:rotate(180deg)}.sk-fading-circle .sk-circle8{-webkit-transform:rotate(210deg);transform:rotate(210deg)}.sk-fading-circle .sk-circle9{-webkit-transform:rotate(240deg);transform:rotate(240deg)}.sk-fading-circle .sk-circle10{-webkit-transform:rotate(270deg);transform:rotate(270deg)}.sk-fading-circle .sk-circle11{-webkit-transform:rotate(300deg);transform:rotate(300deg)}.sk-fading-circle .sk-circle12{-webkit-transform:rotate(330deg);transform:rotate(330deg)}.sk-fading-circle .sk-circle2:before{-webkit-animation-delay:-1.1s;animation-delay:-1.1s}.sk-fading-circle .sk-circle3:before{-webkit-animation-delay:-1s;animation-delay:-1s}.sk-fading-circle .sk-circle4:before{-webkit-animation-delay:-.9s;animation-delay:-.9s}.sk-fading-circle .sk-circle5:before{-webkit-animation-delay:-.8s;animation-delay:-.8s}.sk-fading-circle .sk-circle6:before{-webkit-animation-delay:-.7s;animation-delay:-.7s}.sk-fading-circle .sk-circle7:before{-webkit-animation-delay:-.6s;animation-delay:-.6s}.sk-fading-circle .sk-circle8:before{-webkit-animation-delay:-.5s;animation-delay:-.5s}.sk-fading-circle .sk-circle9:before{-webkit-animation-delay:-.4s;animation-delay:-.4s}.sk-fading-circle .sk-circle10:before{-webkit-animation-delay:-.3s;animation-delay:-.3s}.sk-fading-circle .sk-circle11:before{-webkit-animation-delay:-.2s;animation-delay:-.2s}.sk-fading-circle .sk-circle12:before{-webkit-animation-delay:-.1s;animation-delay:-.1s}@-webkit-keyframes sk-circleFadeDelay{0%,100%,39%{opacity:0}40%{opacity:1}}@keyframes sk-circleFadeDelay{0%,100%,39%{opacity:0}40%{opacity:1}}"],encapsulation:e.ViewEncapsulation.None,host:{"(document:click)":"handleClick($event)","class":"ng-autocomplete"}}]}],t.ctorParameters=function(){return[{type:e.ElementRef}]},t.propDecorators={searchInput:[{type:e.ViewChild,args:["searchInput"]}],data:[{type:e.Input}],searchKeyword:[{type:e.Input}],placeHolder:[{type:e.Input}],historyIdentifier:[{type:e.Input}],historyHeading:[{type:e.Input}],historyListMaxNumber:[{type:e.Input}],notFoundText:[{type:e.Input}],isLoading:[{type:e.Input}],debounceTime:[{type:e.Input}],initialValue:[{type:e.Input}],selected:[{type:e.Output}],inputChanged:[{type:e.Output}],inputFocused:[{type:e.Output}],opened:[{type:e.Output}],closed:[{type:e.Output}],itemTemplate:[{type:e.ContentChild,args:[e.TemplateRef]},{type:e.Input}],notFoundTemplate:[{type:e.Input}]},t}(),f=function(){function t(){}return t.prototype.transform=function(t,e,i){var n=e.replace(/[\-\[\]\/\{\}\(\)\*\+\?\.\\\^\$\|]/g,"\\$&");n=n.split(" ").filter(function(t){return 0<t.length}).join("|");var s=new RegExp(n,"gi");if(!e)return t;if(i){var o=t[i].replace(s,function(t){return"<b>"+t+"</b>"});return c({},t,{name:o})}return e?t.replace(s,function(t){return"<b>"+t+"</b>"}):t},t.decorators=[{type:e.Pipe,args:[{name:"highlight"}]}],t}(),y=function(){function t(){}return t.decorators=[{type:e.NgModule,args:[{imports:[o.CommonModule,s.FormsModule],declarations:[a,g,f],exports:[a,g]}]}],t}();t.AutocompleteLibService=r,t.AutocompleteLibComponent=a,t.AutocompleteLibModule=y,t.AutocompleteComponent=g,t.HighlightPipe=f,Object.defineProperty(t,"__esModule",{value:!0})});
//# sourceMappingURL=autocomplete-lib.umd.min.js.map